<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Histórico - Módulo Ganados</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="manifest" href="manifest.webmanifest" />
    <meta name="theme-color" content="#4f46e5" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="tw-config.js"></script>
  </head>
  <body class="bg-slate-100 text-slate-900 font-sans min-h-screen">
    <!-- HEADER SUPERIOR -->
    <header class="bg-indigo-600 text-white shadow">
      <div class="w-full px-4 md:px-8 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <h1 class="text-xl md:text-2xl font-semibold tracking-wide">
            Inicio
          </h1>
        </div>

        <div class="flex items-center gap-4">
          <span class="hidden md:inline text-sm text-indigo-100">
            Histórico
          </span>

          <!-- Botón cerrar sesión -->
          <button
            id="btn-logout"
            type="button"
            class="flex items-center gap-2 bg-white/10 hover:bg-white/20 px-4 py-2 rounded-full text-sm font-medium transition-colors"
          >
            <span
              class="inline-flex h-6 w-6 rounded-full bg-white/20 items-center justify-center text-xs"
            >
              ⎋
            </span>
            <span>Cerrar sesión</span>
          </button>
        </div>
      </div>
    </header>

    <!-- CONTENIDO -->
    <main
      class="w-full px-3 sm:px-4 md:px-8 lg:px-12 py-6 md:py-8 space-y-6 md:space-y-8"
    >
      <!-- TÍTULO / BOTONES PRINCIPALES -->
      <section class="bg-white rounded-2xl shadow px-4 md:px-8 py-5 md:py-6">
        <div class="text-center mb-4 md:mb-5">
          <h2 class="text-lg md:text-2xl font-semibold text-slate-900">
            Histórico
          </h2>
        </div>

        <div class="flex flex-wrap gap-3 justify-center md:justify-center mb-4">
          <!-- REDIRECCIONES A LAS PÁGINAS -->
          <button
            type="button"
            class="px-5 py-2 text-sm md:text-base rounded-full bg-indigo-600 text-white font-semibold shadow hover:bg-indigo-700 transition-colors"
            onclick="window.location.href='/ingreso'"
          >
            Nuevo ingreso
          </button>
          <button
            type="button"
            class="px-5 py-2 text-sm md:text-base rounded-full bg-emerald-600 text-white font-semibold shadow hover:bg-emerald-700 transition-colors"
            onclick="window.location.href='/salida'"
          >
            Nueva salida
          </button>
          <button
            type="button"
            class="px-5 py-2 text-sm md:text-base rounded-full bg-amber-500 text-white font-semibold shadow hover:bg-amber-600 transition-colors"
            onclick="window.location.href='/modificaciones'"
          >
            Modificaciones
          </button>
        </div>

        <!-- Tabs Ingreso / Salida -->
        <div class="mt-2 flex justify-center">
          <div
            class="inline-flex rounded-full overflow-hidden bg-indigo-50 border border-indigo-200"
          >
            <button
              id="btn-ingreso"
              type="button"
              class="tab-btn px-8 py-2 text-sm md:text-base font-semibold"
            >
              Ingreso
            </button>
            <button
              id="btn-salida"
              type="button"
              class="tab-btn px-8 py-2 text-sm md:text-base font-semibold"
            >
              Salida
            </button>
          </div>
        </div>
      </section>

      <!-- TOTALES (según filtros + selección) -->
      <section class="grid gap-4 md:gap-5 md:grid-cols-5 w-full">
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Registros (contexto)
          </p>
          <p
            id="total-general"
            class="mt-2 text-2xl md:text-3xl font-bold text-slate-900"
          >
            0
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Ingresos
          </p>
          <p
            id="total-ingresos"
            class="mt-2 text-2xl md:text-3xl font-bold text-emerald-600"
          >
            0
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Salidas
          </p>
          <p
            id="total-salidas"
            class="mt-2 text-2xl md:text-3xl font-bold text-rose-500"
          >
            0
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Total ingreso
          </p>
          <p
            id="total-valor-ingreso"
            class="mt-2 text-2xl md:text-3xl font-bold text-indigo-600"
          >
            $0
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Total salida
          </p>
          <p
            id="total-valor-salida"
            class="mt-2 text-2xl md:text-3xl font-bold text-fuchsia-600"
          >
            $0
          </p>
        </div>
      </section>

      <!-- ESTADÍSTICAS -->
      <section class="grid gap-4 md:gap-5 md:grid-cols-3 w-full">
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Peso promedio ingreso
          </p>
          <p
            id="stat-peso-ing"
            class="mt-2 text-xl md:text-2xl font-semibold text-slate-900"
          >
            -
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Peso promedio salida
          </p>
          <p
            id="stat-peso-sal"
            class="mt-2 text-xl md:text-2xl font-semibold text-slate-900"
          >
            -
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Ganancia promedio de peso
          </p>
          <p
            id="stat-peso-ganancia"
            class="mt-2 text-xl md:text-2xl font-semibold text-emerald-700"
          >
            -
          </p>
        </div>
      </section>

      <section class="grid gap-4 md:gap-5 md:grid-cols-3 w-full">
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Valor promedio ingreso
          </p>
          <p
            id="stat-valor-ing"
            class="mt-2 text-xl md:text-2xl font-semibold text-indigo-700"
          >
            -
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Valor promedio salida
          </p>
          <p
            id="stat-valor-sal"
            class="mt-2 text-xl md:text-2xl font-semibold text-fuchsia-700"
          >
            -
          </p>
        </div>
        <div class="bg-white rounded-2xl shadow px-4 py-4 md:px-5 md:py-5">
          <p
            class="text-[11px] md:text-xs uppercase tracking-wide text-slate-500"
          >
            Predicción simple
          </p>
          <p
            id="stat-prediccion"
            class="mt-2 text-sm md:text-base font-medium text-slate-700 leading-relaxed"
          >
            -
          </p>
        </div>
      </section>

      <!-- BARRA DE ACCIONES -->
      <section
        class="bg-white rounded-2xl shadow px-4 py-4 md:px-6 md:py-5 flex flex-col md:flex-row md:items-center md:justify-between gap-3"
      >
        <div class="flex flex-wrap items-center gap-3">
          <button
            id="btn-actualizar"
            type="button"
            class="px-4 py-2 text-sm md:text-base rounded-full border border-slate-300 bg-white hover:bg-slate-50 flex items-center gap-2"
          >
            <span class="text-base">⟳</span>
            <span>Actualizar</span>
          </button>
        </div>

        <div class="flex flex-col items-start md:items-end gap-2">
          <p
            id="selection-info"
            class="text-[11px] md:text-xs text-slate-500 text-left md:text-right"
          >
            Totales basados en todos los registros filtrados.
          </p>
          <div class="flex flex-wrap gap-2">
            <button
              id="btn-exportar-todo"
              type="button"
              class="px-4 py-2 text-sm md:text-base rounded-full border border-indigo-300 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 flex items-center gap-2"
            >
              <span class="text-base">⬇</span>
              <span>Exportar todo</span>
            </button>

            <button
              id="btn-exportar-vista"
              type="button"
              class="px-4 py-2 text-sm md:text-base rounded-full bg-indigo-600 text-white font-semibold hover:bg-indigo-700 shadow-sm flex items-center gap-2"
            >
              <span class="text-base">⬇</span>
              <span>Exportar vista actual</span>
            </button>
          </div>
        </div>
      </section>

      <!-- TABLA -->
      <section class="relative w-full">
        <!-- Botones de scroll horizontal (solo desktop) -->
        <button
          id="scroll-left"
          type="button"
          class="hidden md:flex items-center justify-center h-9 w-9 rounded-full bg-white shadow border border-slate-200 absolute left-0 top-1/2 -translate-y-1/2 -translate-x-1/2 z-10"
        >
          ‹
        </button>
        <button
          id="scroll-right"
          type="button"
          class="hidden md:flex items-center justify-center h-9 w-9 rounded-full bg-white shadow border border-slate-200 absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2 z-10"
        >
          ›
        </button>

        <div
          id="tabla-wrapper"
          class="overflow-x-auto bg-white rounded-2xl shadow border border-slate-200"
        >
          <table
            id="tabla"
            class="min-w-[1100px] text-sm md:text-base divide-y divide-slate-200"
          >
            <thead id="tabla-head"></thead>
            <tbody
              id="tabla-body"
              class="divide-y divide-slate-100 text-slate-800"
            ></tbody>
          </table>
        </div>
      </section>
    </main>

    <!-- MODAL CERRAR SESIÓN -->
    <div
      id="logout-modal"
      class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-40 hidden"
    >
      <div
        class="bg-white rounded-2xl shadow-xl w-full max-w-sm px-6 py-5 space-y-4"
      >
        <h3 class="text-base md:text-lg font-semibold text-slate-900">
          ¿Cerrar sesión?
        </h3>
        <p class="text-sm md:text-base text-slate-700">
          Se cerrará tu sesión actual en el Módulo Ganados y volverás a la
          pantalla de inicio de sesión.
        </p>
        <div class="flex justify-end gap-2 pt-2">
          <button
            id="logout-cancel"
            type="button"
            class="px-4 py-2 text-sm rounded-full border border-slate-300 bg-white hover:bg-slate-50"
          >
            Cancelar
          </button>
          <button
            id="logout-confirm"
            type="button"
            class="px-4 py-2 text-sm rounded-full bg-rose-600 text-white font-semibold hover:bg-rose-700"
          >
            Cerrar sesión
          </button>
        </div>
      </div>
    </div>

    <!-- XLSX para exportar -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="dashboard.js" defer></script>
    <script src="pwa.js" defer></script>

  </body>
</html>
